use v6;
use Test;
plan 6;

use PDF::Tags;
use PDF::Tags::Elem;
use PDF::Style::Body;
use PDF::Style::Element;
use CSS::TagSet::TaggedPDF;
use CSS::Properties;
use PDF::Class;
my PDF::Class $pdf .= new;
my PDF::Style::Body $body .= new;
my $page = $body.decorate: $pdf.add-page;
my CSS::TagSet::TaggedPDF $styler .= new;
my PDF::Tags $tags .= create: :$pdf, :$styler;
my PDF::Tags::Elem $doc = $tags.Document;
my PDF::Tags::Elem $header = $doc.Header1;
my PDF::Tags::Elem $figure = $doc.Figure: :Alt("light bulb");
my $elem = $body.element: :text("Tagged/Styled PDF Demo"), :tag($header);
ok $elem.tag.defined;
is $elem.css, "display:block; font-size:2em; font-weight:bolder; margin-bottom:0.67em; margin-top:0.67em; unicode-bidi:embed;";
isa-ok $elem.tag, 'PDF::Tags::Elem';
.render(10, 750) with $elem;
my Str $image = "t/images/snoopy-happy-dance.jpg";
my CSS::Properties() $css = "padding:2px; border:1px dashed red; opacity:0.5";
my $image-elem = $body.element(:$image, :tag($figure), :$css);
is $image-elem.css, "border:1px dashed red; opacity:0.5; padding:2px;";
ok $image-elem.gfx.defined;
.render(10, 550) with $image-elem;
lives-ok {$pdf.save-as: "t/tagged.pdf"};
